  deriv_x(dx_alpha,alpha,dx, nx, ny, nz);
  deriv_xx(dxx_alpha,alpha,dx, nx, ny, nz);
  deriv_x(dx_shiftx,shiftx,dx, nx, ny, nz);
  deriv_xx(dxx_shiftx,shiftx,dx, nx, ny, nz);
  deriv_x(dx_shifty,shifty,dx, nx, ny, nz);
  deriv_xx(dxx_shifty,shifty,dx, nx, ny, nz);
  deriv_x(dx_shiftz,shiftz,dx, nx, ny, nz);
  deriv_xx(dxx_shiftz,shiftz,dx, nx, ny, nz);
  deriv_x(dx_gbx,gbx,dx, nx, ny, nz);
  deriv_x(dx_gby,gby,dx, nx, ny, nz);
  deriv_x(dx_gbz,gbz,dx, nx, ny, nz);
  deriv_x(dx_chi,chi,dx, nx, ny, nz);
  deriv_xx(dxx_chi,chi,dx, nx, ny, nz);
  deriv_x(dx_Gamtx,Gamtx,dx, nx, ny, nz);
  deriv_x(dx_Gamty,Gamty,dx, nx, ny, nz);
  deriv_x(dx_Gamtz,Gamtz,dx, nx, ny, nz);
  deriv_x(dx_trK,trK,dx, nx, ny, nz);
  deriv_x(dx_gtxx,gtxx,dx, nx, ny, nz);
  deriv_xx(dxx_gtxx,gtxx,dx, nx, ny, nz);
  deriv_x(dx_gtxy,gtxy,dx, nx, ny, nz);
  deriv_xx(dxx_gtxy,gtxy,dx, nx, ny, nz);
  deriv_x(dx_gtxz,gtxz,dx, nx, ny, nz);
  deriv_xx(dxx_gtxz,gtxz,dx, nx, ny, nz);
  deriv_x(dx_gtyy,gtyy,dx, nx, ny, nz);
  deriv_xx(dxx_gtyy,gtyy,dx, nx, ny, nz);
  deriv_x(dx_gtyz,gtyz,dx, nx, ny, nz);
  deriv_xx(dxx_gtyz,gtyz,dx, nx, ny, nz);
  deriv_x(dx_gtzz,gtzz,dx, nx, ny, nz);
  deriv_xx(dxx_gtzz,gtzz,dx, nx, ny, nz);
  deriv_x(dx_Atxx,Atxx,dx, nx, ny, nz);
  deriv_x(dx_Atxy,Atxy,dx, nx, ny, nz);
  deriv_x(dx_Atxz,Atxz,dx, nx, ny, nz);
  deriv_x(dx_Atyy,Atyy,dx, nx, ny, nz);
  deriv_x(dx_Atyz,Atyz,dx, nx, ny, nz);
  deriv_x(dx_Atzz,Atzz,dx, nx, ny, nz);
  double *ft  = new double [nd];
  double *dft = new double [nd];
  transpose_xy(ft, alpha,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_alpha,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_alpha,dft, ny, nx, nz);
  transpose_xy(ft, shiftx,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_shiftx,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_shiftx,dft, ny, nx, nz);
  transpose_xy(ft, shifty,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_shifty,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_shifty,dft, ny, nx, nz);
  transpose_xy(ft, shiftz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_shiftz,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_shiftz,dft, ny, nx, nz);
  transpose_xy(ft, gbx,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gbx,dft, ny, nx, nz);
  transpose_xy(ft, gby,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gby,dft, ny, nx, nz);
  transpose_xy(ft, gbz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gbz,dft, ny, nx, nz);
  transpose_xy(ft, chi,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_chi,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_chi,dft, ny, nx, nz);
  transpose_xy(ft, Gamtx,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Gamtx,dft, ny, nx, nz);
  transpose_xy(ft, Gamty,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Gamty,dft, ny, nx, nz);
  transpose_xy(ft, Gamtz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Gamtz,dft, ny, nx, nz);
  transpose_xy(ft, trK,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_trK,dft, ny, nx, nz);
  transpose_xy(ft, gtxx,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gtxx,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_gtxx,dft, ny, nx, nz);
  transpose_xy(ft, gtxy,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gtxy,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_gtxy,dft, ny, nx, nz);
  transpose_xy(ft, gtxz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gtxz,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_gtxz,dft, ny, nx, nz);
  transpose_xy(ft, gtyy,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gtyy,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_gtyy,dft, ny, nx, nz);
  transpose_xy(ft, gtyz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gtyz,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_gtyz,dft, ny, nx, nz);
  transpose_xy(ft, gtzz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_gtzz,dft, ny, nx, nz);
  deriv_xx(dft,ft,dy, ny, nx, nz);
  transpose_xy(dyy_gtzz,dft, ny, nx, nz);
  transpose_xy(ft, Atxx,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Atxx,dft, ny, nx, nz);
  transpose_xy(ft, Atxy,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Atxy,dft, ny, nx, nz);
  transpose_xy(ft, Atxz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Atxz,dft, ny, nx, nz);
  transpose_xy(ft, Atyy,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Atyy,dft, ny, nx, nz);
  transpose_xy(ft, Atyz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Atyz,dft, ny, nx, nz);
  transpose_xy(ft, Atzz,nx, ny, nz);
  deriv_x(dft,ft,dy, ny, nx, nz);
  transpose_xy(dy_Atzz,dft, ny, nx, nz);
  transpose_xz(ft, alpha,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_alpha,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_alpha,dft, nz, ny, nx);
  transpose_xz(ft, shiftx,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_shiftx,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_shiftx,dft, nz, ny, nx);
  transpose_xz(ft, shifty,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_shifty,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_shifty,dft, nz, ny, nx);
  transpose_xz(ft, shiftz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_shiftz,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_shiftz,dft, nz, ny, nx);
  transpose_xz(ft, gbx,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gbx,dft, nz, ny, nx);
  transpose_xz(ft, gby,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gby,dft, nz, ny, nx);
  transpose_xz(ft, gbz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gbz,dft, nz, ny, nx);
  transpose_xz(ft, chi,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_chi,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_chi,dft, nz, ny, nx);
  transpose_xz(ft, Gamtx,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Gamtx,dft, nz, ny, nx);
  transpose_xz(ft, Gamty,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Gamty,dft, nz, ny, nx);
  transpose_xz(ft, Gamtz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Gamtz,dft, nz, ny, nx);
  transpose_xz(ft, trK,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_trK,dft, nz, ny, nx);
  transpose_xz(ft, gtxx,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gtxx,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_gtxx,dft, nz, ny, nx);
  transpose_xz(ft, gtxy,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gtxy,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_gtxy,dft, nz, ny, nx);
  transpose_xz(ft, gtxz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gtxz,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_gtxz,dft, nz, ny, nx);
  transpose_xz(ft, gtyy,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gtyy,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_gtyy,dft, nz, ny, nx);
  transpose_xz(ft, gtyz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gtyz,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_gtyz,dft, nz, ny, nx);
  transpose_xz(ft, gtzz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_gtzz,dft, nz, ny, nx);
  deriv_xx(dft,ft,dz, nz, ny, nx);
  transpose_xz(dzz_gtzz,dft, nz, ny, nx);
  transpose_xz(ft, Atxx,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Atxx,dft, nz, ny, nx);
  transpose_xz(ft, Atxy,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Atxy,dft, nz, ny, nx);
  transpose_xz(ft, Atxz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Atxz,dft, nz, ny, nx);
  transpose_xz(ft, Atyy,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Atyy,dft, nz, ny, nx);
  transpose_xz(ft, Atyz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Atyz,dft, nz, ny, nx);
  transpose_xz(ft, Atzz,nx, ny, nz);
  deriv_x(dft,ft,dz, nz, ny, nx);
  transpose_xz(dz_Atzz,dft, nz, ny, nx);
  deriv_x(dxy_gtxx,dy_gtxx,dx, nx, ny, nz);
  deriv_x(dxz_gtxx,dz_gtxx,dx, nx, ny, nz);
  deriv_y(dyz_gtxx,dz_gtxx,dy, nx, ny, nz);
  deriv_x(dxy_gtxy,dy_gtxy,dx, nx, ny, nz);
  deriv_x(dxz_gtxy,dz_gtxy,dx, nx, ny, nz);
  deriv_y(dyz_gtxy,dz_gtxy,dy, nx, ny, nz);
  deriv_x(dxy_gtxz,dy_gtxz,dx, nx, ny, nz);
  deriv_x(dxz_gtxz,dz_gtxz,dx, nx, ny, nz);
  deriv_y(dyz_gtxz,dz_gtxz,dy, nx, ny, nz);
  deriv_x(dxy_gtyy,dy_gtyy,dx, nx, ny, nz);
  deriv_x(dxz_gtyy,dz_gtyy,dx, nx, ny, nz);
  deriv_y(dyz_gtyy,dz_gtyy,dy, nx, ny, nz);
  deriv_x(dxy_gtyz,dy_gtyz,dx, nx, ny, nz);
  deriv_x(dxz_gtyz,dz_gtyz,dx, nx, ny, nz);
  deriv_y(dyz_gtyz,dz_gtyz,dy, nx, ny, nz);
  deriv_x(dxy_gtzz,dy_gtzz,dx, nx, ny, nz);
  deriv_x(dxz_gtzz,dz_gtzz,dx, nx, ny, nz);
  deriv_y(dyz_gtzz,dz_gtzz,dy, nx, ny, nz);
  deriv_x(dxy_chi,dy_chi,dx, nx, ny, nz);
  deriv_x(dxz_chi,dz_chi,dx, nx, ny, nz);
  deriv_y(dyz_chi,dz_chi,dy, nx, ny, nz);
  deriv_x(dxy_alpha,dy_alpha,dx, nx, ny, nz);
  deriv_x(dxz_alpha,dz_alpha,dx, nx, ny, nz);
  deriv_y(dyz_alpha,dz_alpha,dy, nx, ny, nz);
  deriv_x(dxy_shiftx,dy_shiftx,dx, nx, ny, nz);
  deriv_x(dxz_shiftx,dz_shiftx,dx, nx, ny, nz);
  deriv_y(dyz_shiftx,dz_shiftx,dy, nx, ny, nz);
  deriv_x(dxy_shifty,dy_shifty,dx, nx, ny, nz);
  deriv_x(dxz_shifty,dz_shifty,dx, nx, ny, nz);
  deriv_y(dyz_shifty,dz_shifty,dy, nx, ny, nz);
  deriv_x(dxy_shiftz,dy_shiftz,dx, nx, ny, nz);
  deriv_x(dxz_shiftz,dz_shiftz,dx, nx, ny, nz);
  deriv_y(dyz_shiftz,dz_shiftz,dy, nx, ny, nz);
